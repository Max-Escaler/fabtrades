# Test Logging Improvements

## Overview

The test suite has been enhanced with comprehensive logging capabilities that automatically capture and save failed test results to log files for easier review and debugging.

## Key Features

### 1. Automatic Log File Generation

When tests fail, the system automatically creates two types of log files:

#### Full Test Results Log
- **Location**: `test-logs/test-results-{timestamp}.log`
- **Content**: Complete test output including all console output, errors, and coverage information
- **Format**: Markdown with sections for full output, error output, and summary

#### Failed Tests Summary Log
- **Location**: `test-logs/failed-tests-{timestamp}.log`
- **Content**: Condensed summary of only the failed tests
- **Format**: Markdown with numbered list of failed tests and their errors

### 2. Enhanced Test Runner

The `runTests.js` script now includes:

- **Output Capture**: Captures both stdout and stderr while still displaying in real-time
- **Failure Detection**: Automatically detects when tests fail
- **Log Generation**: Creates timestamped log files for each test run
- **Summary Reporting**: Shows file locations after test completion

### 3. Log Viewer Utility

A new `viewLogs.js` script provides easy access to test logs:

```bash
# Show summary of latest test results
node scripts/viewLogs.js

# Show full test results log
node scripts/viewLogs.js full

# Show failed tests summary
node scripts/viewLogs.js failed

# List all available log files
node scripts/viewLogs.js list

# Show help
node scripts/viewLogs.js help
```

## Usage Examples

### Running Tests with Logging

```bash
# Run tests with automatic log generation
node scripts/runTests.js test

# Run coverage tests with logging
node scripts/runTests.js coverage

# Run full test suite with logging
node scripts/runTests.js full
```

### Viewing Logs

```bash
# Quick summary of latest results
npm run test:logs

# View full test results
npm run test:logs full

# View only failed tests
npm run test:logs failed

# List all log files
npm run test:logs list
```

### Using npm Scripts

```bash
# Run tests with logging
npm run test:run test

# View logs
npm run test:logs
```

## Log File Structure

### Full Test Results Log Format

```markdown
# FAB Trades Test Results
Generated: 9/2/2025, 12:43:40 PM
Command: test
Timestamp: 2025-09-02T16-43-40-904Z

## Full Output
```
[Complete test output]
```

## Error Output
```
[Error output if any]
```

## Summary
- Command: test
- Exit Code: Tests ran
- Log File: /path/to/log/file
```

### Failed Tests Summary Format

```markdown
# Failed Tests Summary
Generated: 9/2/2025, 12:43:40 PM
Command: test
Total Failed Tests: 5

## Failed Tests:

### 1. CardList Component › Edition Management › clicking card opens edition picker
**Error:** Unable to find an element with the text: Select Edition

### 2. CardList Component › Edition Management › edition picker shows available editions
**Error:** TestingLibraryElementError: Unable to find an element with the text: Select Edition

[Additional failed tests...]

Generated by: node scripts/runTests.js test
Log file: /path/to/summary/file
```

## Benefits

### For Developers
- **Easy Debugging**: Failed tests are clearly documented with full context
- **Historical Tracking**: All test runs are logged with timestamps
- **Quick Review**: Summary logs provide fast overview of issues
- **No Lost Information**: Complete output is preserved even for long test runs

### For CI/CD
- **Artifact Generation**: Log files can be saved as build artifacts
- **Failure Analysis**: Detailed logs help identify root causes
- **Regression Tracking**: Historical logs help track test stability

### For Teams
- **Shared Debugging**: Log files can be shared with team members
- **Issue Documentation**: Failed tests are automatically documented
- **Progress Tracking**: Easy to see test improvement over time

## File Management

### Log Directory Structure
```
test-logs/
├── test-results-2025-09-02T16-43-40-904Z.log
├── failed-tests-2025-09-02T16-43-40-904Z.log
├── test-results-2025-09-02T15-30-20-123Z.log
└── failed-tests-2025-09-02T15-30-20-123Z.log
```

### Automatic Cleanup
- Log files are timestamped for easy identification
- No automatic deletion (manual cleanup recommended)
- Files are sorted by date for easy access

## Configuration

### Log File Location
- **Default**: `test-logs/` directory in project root
- **Customizable**: Modify `logDir` path in scripts if needed

### Log File Naming
- **Format**: `{type}-{ISO-timestamp}.log`
- **Examples**: 
  - `test-results-2025-09-02T16-43-40-904Z.log`
  - `failed-tests-2025-09-02T16-43-40-904Z.log`

### Log Content
- **Full Output**: Complete test execution output
- **Error Output**: Separate error stream capture
- **Metadata**: Command, timestamp, and file information

## Integration with Existing Workflow

### Before (Old System)
```bash
npm test
# Output scrolls past, errors lost in terminal
# No persistent record of failures
```

### After (New System)
```bash
npm run test:run test
# Output displayed in real-time
# Log files automatically created
# Easy access to failed test details
```

## Future Enhancements

Potential improvements:
- **Log Rotation**: Automatic cleanup of old log files
- **Email Notifications**: Send failed test summaries via email
- **Web Dashboard**: Web interface for viewing test results
- **Integration**: Connect with issue tracking systems
- **Metrics**: Track test failure patterns over time

## Conclusion

The test logging improvements provide a robust foundation for test result management, making it easier to debug failures, track progress, and maintain test quality. The automatic log generation and easy access tools significantly improve the developer experience when working with test failures.
